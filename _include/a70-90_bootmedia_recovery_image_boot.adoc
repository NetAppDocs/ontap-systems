You must boot the ONTAP image from the USB drive, restore the file system, and verify the environmental variables.

.Steps

. From the LOADER prompt, boot the recovery image from the USB flash drive: _boot_recovery_
+
The image is downloaded from the USB flash drive.

. When prompted, either enter the name of the image or accept the default image displayed inside the brackets on your screen.
. Restore the var file system:
+

[options="header" cols="1,2"]

| If your system is running...| Then...
| 
a|
ONTAP 9.16.0 or earlier
a|
.. On the impaired controller, press _Y_ when you see `Do you want to restore the backup configuration now?` 

.. On the impaired controller, press _Y_ when prompted to overwrite `/etc/ssh/ssh_host_ecdsa_key`. 

.. On the healthy partner controller, set the impaired controller to advanced privilege level: _set -privilege advanced_.

.. On the healthy partner controller, run the restore backup command: _system node restore-backup -node local -target-address impaired_node_IP_address_.

+
*NOTE:*  If you see any message other than a successful restore, contact https://support.netapp.com[NetApp Support].

.. On the healthy partner controller, return the impaired controller to admin level: _set -privilege admin_.

.. On the impaired controller, press _y_ when you see `Was the restore backup procedure successful?`.

.. On the impaired controller, press _y_ when you see `...would you like to use this restored copy now?`. 

.. On the impaired controller, press _y_ when prompted to reboot the impaired controller and press _ctrl-c_ for the Boot Menu.

.. If the system does not use encyption, select _Option 1 Normal Boot._, otherwise go to link:bootmedia-encryption-restore.html[Restore key managers].

.. Connect the console cable to the partner controller.

.. Give back the controller using the _storage failover giveback -fromnode local_ command.

.. Restore automatic giveback if you disabled it by using the _storage failover modify -node local -auto-giveback true_ command.

.. If AutoSupport is enabled, restore/unsuppress automatic case creation by using the _system node autosupport invoke -node * -type all -message MAINT=END_ command.
+
*NOTE:* If the process fails, contact https://support.netapp.com[NetApp Support].
+

a|
ONTAP 9.16.1 or later
a| 
.. On the impaired controller, press _y_ when prompted to restore the backup configuration. 
+
After restore procedure is successful, this message will be seen on the console - `syncflash_partner: Restore from partner complete`.

.. On the impaired controller, press _y_ when prompted to confirm if the restore backup was successful.
.. On the impaired controller, press _y_ when prompted to use the restored configuration.
.. On the impaired controller, press _y_ when prompted to reboot the node.

.. On the impaired controller, press _y_ when prompted to reboot the impaired controller and press _ctrl-c_ for the Boot Menu.

.. If the system does not use encyption, select _Option 1 Normal Boot._, otherwise go to link:bootmedia-encryption-restore.html[Restore key managers].

.. Connect the console cable to the partner controller.

.. Give back the controller using the _storage failover giveback -fromnode local_ command.

.. Restore automatic giveback if you disabled it by using the _storage failover modify -node local -auto-giveback true_ command.

.. If AutoSupport is enabled, restore/unsuppress automatic case creation by using the _system node autosupport invoke -node * -type all -message MAINT=END_ command.
+
*NOTE:* If the process fails, contact https://support.netapp.com[NetApp Support].
+

