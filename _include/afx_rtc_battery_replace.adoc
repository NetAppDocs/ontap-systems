.Before you begin
* Understand that you can use this procedure with all versions of ONTAP supported by your system.
* Make sure all other components in the system are functioning properly; if not, you must contact technical support.

== Step 1: Shut down the impaired controller

Shut down or take over the impaired controller using one of the following options.

include::../_include/shutdown_most_frus_afx.adoc[]

== Step 2: Remove the controller module

include::../_include/afx_controller_remove_physical.adoc[]
 
== Step 3: Replace the RTC battery

Remove failed RTC battery and install the replacement RTC battery.

. Open the controller air duct on the top of the controller.
.. Insert your fingers in the recesses at the far ends of the air duct.
.. Lift the air duct and rotate it upward as far as it will go.
. Locate the RTC battery under the air duct.
+
image::../media/drw_a1k_rtc_remove_replace_ieops-1381.svg[Replace the RTC battery]
+
[cols="1,4"]

|===
a|
image:../media/icon_round_1.png[Callout number 1] |
RTC battery and housing
|===

. Gently push the battery away from the holder, rotate it away from the holder, and then lift it out of the holder.
+
NOTE: Observe the polarity of the battery as you remove it from the holder. The battery is marked with a plus sign and must be positioned in the holder correctly. A plus sign near the holder indicates the correct orientation.

. Remove the replacement battery from the antistatic shipping bag.
. Note the polarity of the RTC battery, and then insert it into the holder by tilting the battery at an angle and pushing down.
. Visually inspect the battery to make sure that it is completely installed into the holder and that the polarity is correct.

== Step 4: Reinstall the controller module

Reinstall the controller module and boot it.

. Ensure the air duct is completely closed by rotating it down as far as it will go.
+
It must lie flush against the controller module sheet metal.

. Align the end of the controller module with the opening in the enclosure, and slide the controller module into the chassis with the levers rotated away from the front of the system.

. Once the controller module stops you from sliding it farther, rotate the cam handles inward until they latch back under the fans

+
NOTE: Do not use excessive force when sliding the controller module into the enclosure to avoid damaging the connectors.
+
The controller module begins to boot as soon as it is fully seated in the enclosure.

. Align the bezel with the ball studs and then gently push the bezel into place.

== Step 5: Reset the time and date on the controller

NOTE: After replacing the RTC battery, inserting controller and powering on first BIOS reset, you will see the following error messages: 
`RTC date/time error. Reset date/time to default`
`RTC power failure error`
These messages are excpected and you can continue with this procedure.

. Check the date and time on the healthy controller with the `cluster date show` command.
+
NOTE: If your system stops at the boot menu, select the option for  `Reboot node` and respond _y_ when prompted, then boot to LOADER by pressing _Ctrl-C_
+
 .. At the LOADER prompt on the target controller, check the time and date with the `show date` command.
 .. If necessary, modify the date with the `set date mm/dd/yyyy` command.
 .. If necessary, set the time, in GMT, using the `set time hh:mm:ss` command.

. Confirm the date and time on the target controller.
. At the LOADER prompt, enter `bye` to reinitialize the PCIe cards and other components and let the controller reboot.
. Return the impaired controller to normal operation by giving back its storage: 
+
`storage failover giveback -ofnode _impaired_node_name_`

. If automatic giveback was disabled, reenable it:
+
`storage failover modify -node local -auto-giveback true`

. If AutoSupport is enabled, restore/unsuppress automatic case creation:
+ 
`system node autosupport invoke -node * -type all -message MAINT=END`

== Step 6: Return the failed part to NetApp

include::../_include/complete_rma.adoc[]
